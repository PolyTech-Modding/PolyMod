<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Static CSS -->
    <link rel="stylesheet" href="/static/navbar.css" />


    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
      crossorigin="anonymous"
      />
    <title>PolyTech Modding Prototype</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
      <div class="container-fluid">
        <a class="navbar-brand pt-1" href="/">
          <!-- <object data="static/PolyTech.svg" type="image/svg+xml" class="logo mx-2" style="vertical-align: middle; height: 2rem"></object> -->
          <svg viewBox="0 0 1634 1152" xmlns="http://www.w3.org/2000/svg" class="logo mx-2" style="vertical-align: middle; height: 2rem">
            <defs>
            <style>
              .cls-1 {
                fill: #004d70;
              }
              .cls-2 {
                fill: #00c4ff;
              }
              .cls-3 {
                fill: #007ead;
              }
              .cls-4 {
                fill: #000a75;
              }
              .cls-5 {
                fill: #0048ff;
              }
              .cls-6 {
                fill: #00ff2c;
              }
              .cls-7 {
                fill: #00941a;
              }
            </style>
            </defs>

            <g data-name="Right Cube">
            <g data-name="Axo Surface*">
            <polygon class="cls-4" points="1246.8 892.78 1246.8 452.29 1628.3 232.04 1628.3 672.53" />
            <polygon class="cls-5" points="1246.8 452.29 865.37 232.04 1246.8 11.79 1628.3 232.04" />
            </g>
            </g>
            <g data-name="Left Cube">
            <g data-name="Axo Surface*">
            <polygon class="cls-6" points="386.61 452.06 5.13 231.82 386.61 11.57 768.09 231.82" />
            </g>
            <g data-name="Axo cap">
            <polygon class="cls-7" points="386.61 892.56 5.13 672.31 5.13 231.82 386.61 452.06" />
            </g>
            </g>
            <g data-name="Middle Cube" class="middlecube">
            <g data-name="Axo Surface*">
            <polygon class="cls-1" points="816.92 1141 816.92 700.51 1198.4 480.26 1198.4 920.75" />
            <polygon class="cls-2" points="816.92 700.51 435.44 480.26 816.92 260.01 1198.4 480.26" />
            </g>
            <g data-name="Axo cap">
            <polygon class="cls-3" points="816.92 1141 435.44 920.75 435.44 480.26 816.92 700.51" />
            </g>
            </g>
          </svg>

          PolyTech Mod Index
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
          >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-sm-0">
            <li class="nav-item">
              <a class="nav-link" href="/search">Mods</a>
            </li>
            <li id="upload_mods_nav_item" class="nav-item" hidden>
              <a class="nav-link" href="/submit">Upload Mods</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Core Mods
              </a>
              <ul id="coreMods" class="dropdown-menu" aria-labelledby="navbarDropdown">
              </ul>
            </li>

          </ul>
          <button id="login_button" class="btn btn-dark mx-2">
            <span class="align-middle">
              <img class="m-1" src="/static/Discord-Logo-White.svg" style="width:32px;height:32px;">Login with Discord
            </span>
          </button>
          <button hidden id="user_button" class="btn btn-dark mx-2" onclick="window.location.href = '/profile'">
            username goes here
          </button>
          <button hidden id="logout_button" class="btn btn-danger mx-2" onclick="window.location.href = '/logout'">
            Logout
          </button>
          
          <select id="team_switcher" class="form-select m-2" style="width: 100px;" onchange="teamSwitch()">
            <option selected value="none">No Team</option>
          </select>
        </div>
      </div>
    </nav>

    <div class="row">
      <div class="col card col-md-8 p-0">
        <div class="card-header">
          <b class="m-2">
            {{ data.name }}
            <span style="float: right">
              {{ data.version }}
            </span>
          </b>
        </div>
  
        <div class="card-body">
          <div id="verification_warnings"></div>
          <div class="card bg-light">
            <div class="card-body d-flex align-items-center">
              <div class="me-auto"><b>Description: </b>{{ data.description }}</div>
              <div class="">
                <button id="download_button" type="button" class="btn mb-1">Download Mod</button>
                <button hidden id="mod_options" type="button" class="btn mb-1 btn-secondary" data-bs-toggle="modal" data-bs-target="#mod_options_modal" onclick="document.getElementById('alerts').innerHTML = ''">Verify</button>
                <button id="yank_button" type="button" class="btn mb-1 btn-secondary" data-bs-toggle="modal" data-bs-target="#yank_modal" onclick="document.getElementById('yank_alerts').innerHTML = ''">Yank Mod</button>
                <button id="transfer_button" type="button" class="btn mb-1 btn-secondary" data-bs-toggle="modal" data-bs-target="#transfer_mod_modal" onclick="document.getElementById('transfer_alerts').innerHTML = ''; configureTransferWindow()">Transfer to Team</button>
              </div>
            </div>
          </div>
  
          <div id="content">{{ data.readme }}</div>
        </div>
      </div>
  
  
      <div class="card col-md-4 p-0 m-0">
        <div class="card-body m-2">
          <table class="table">
            <thead>
              <th scope="colgroup" colspan="2">Details</th>
            </thead>
            <tbody>
              <tr>
                <td>Name</td>
                <td>
                  {{ data.name }}
                </td>
              </tr>
              <tr>
                <td>Version</td>
                <td>
                  {{ data.version }}
                </td>
              </tr>
              <tr>
                <td>Authors</td>
                <td id="detail_authors">
                  {{#each data.authors}}
                      {{ this }}<br>
                  {{/each}}
                </td>
              </tr>
              <tr>
                <td>Verification</td>
                <td id="verification_level">
                  {{ data.verification }}
                </td>
              </tr>
              <tr>
                <td>Release Date</td>
                <td id="release_date"></td>
              </tr>
              <tr>
                <td>License</td>
                <td>{{ data.license }}</td>
              </tr>
              <tr>
                <td>Documentation</td>
                <td>{{ data.documentation }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="modal fade" id="mod_options_modal" tabindex="-1" aria-labelledby="mod_options_modal" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="mod_options_modal_label">Mod Verification</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="alerts"></div>
          <form id="verification_form" action="" method="GET">
            <div class="form-check mb-3">
              <input name="is_good" class="form-check-input" type="checkbox" value="false" onchange="formUpdate()">
              <label class="form-check-label" for="is_good">Is the mod safe?</label>
              <br>
            </div>
            <div class="mb-3">
              <label for="reason" class="form-label">Reason</label>
              <textarea required minlength="60" class="form-control" id="reason" rows="3"></textarea>
            </div>
            <!--<input name="page" value=0 hidden onchange="handleSearch()">-->
          </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" onclick="submitVerification()">Send</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="transfer_mod_modal" tabindex="-1" aria-labelledby="transfer_mod_modal" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="transfer_mod_modal_label">Mod Verification</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
              <div hidden id="mod_name">{{ data.name }}</div>
            <div id="transfer_alerts"></div>
          <form id="transfer_form" action="" method="GET">
            <select id="transfer_target" name="transfer_target" class="form-select form-control-sm">
            </select>
          </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="transferMod()">Transfer</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="yank_modal" tabindex="-1" aria-labelledby="yank_modal" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="yank_modal_label">Are you sure you want to yank this mod?</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="yank_alerts"></div>
            Reason for yanking the mod:
            <input id="yank_reason" class="form-control">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" onclick="yankMod()">Yank Mod</button>
          </div>
        </div>
      </div>
    </div>
    
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
      crossorigin="anonymous">
    </script>
    <div id="files" style="display: none">{{#each data.files}}{{ this }}<br>{{/each}}</div>
    <div id="uploaded" style="display: none">{{ data.uploaded }}</div>
    <div id="readme_filename" style="display: none">{{ data.readme_filename }}</div>
    <script src="/static/util.js"></script>
    <script type="text/javascript" src="static/purify.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script type="text/javascript" src="/static/creole_parser.min.js"></script>
    <script type="text/javascript" src="/static/orgmode_parser.js"></script>
    
    <script defer src="/static/mod_view.js"></script>
  </body>
</html>